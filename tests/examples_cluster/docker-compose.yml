networks:
  public:
    name: scylla_cpp_driver_public
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.43.0.0/16
services:
  scylla:
    image: scylladb/scylla
    networks:
      public:
        ipv4_address: 172.43.0.2
    command: |
      --rpc-address 172.43.0.2
      --listen-address 172.43.0.2
      --skip-wait-for-gossip-to-settle 0
      --ring-delay-ms 0
      --smp 2
      --memory 1G
    healthcheck:
      test:
        [
          "CMD",
          "cqlsh",
          "scylla",
          "-e",
          "select * from system.local WHERE key='local'",
        ]
      interval: 5s
      timeout: 5s
      retries: 60
